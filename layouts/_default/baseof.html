{{/*
  Template: baseof.html
  Purpose: Base HTML template for all pages

  Blocks:
  - "main": Page content
  - "scripts": Page-specific JavaScript

  Security:
  - CSP meta tag restricts resource loading
  - unsafe-inline required for Hugo's style fingerprinting

  Note: For production with custom domains, consider moving CSP to HTTP headers
*/}}
<!doctype html>
<html lang="{{ .Site.Language.Lang | default "en" }}" data-hugo-env="{{ hugo.Environment }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{- if .IsHome -}}{{ .Site.Title }}{{- else -}}{{ .Title }} | {{ .Site.Title }}{{- end -}}</title>
  <meta name="description" content="{{ with .Description }}{{ . }}{{ else }}{{ with .Summary }}{{ . | plainify }}{{ else }}{{ .Site.Params.description }}{{ end }}{{ end }}">
  {{/* Content Security Policy - restrictive by default */}}
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self'; font-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">
  {{ with .Permalink }}<link rel="canonical" href="{{ . }}">{{ end }}
  {{ with .OutputFormats.Get "rss" }}<link rel="alternate" type="application/rss+xml" title="{{ $.Site.Title }}" href="{{ .Permalink }}">{{ end }}
  {{- template "_internal/opengraph.html" . -}}
  {{- template "_internal/twitter_cards.html" . -}}

  {{/* Focus with Justin â€” Starter Theme */}}
  {{ $theme := resources.Get "css/theme.css" | minify | fingerprint }}
  <link rel="stylesheet" href="{{ $theme.RelPermalink }}" integrity="{{ $theme.Data.Integrity }}">
</head>
<body>
  {{ partial "header.html" . }}

  {{ block "main" . }}{{ end }}

  {{ partial "footer.html" . }}

  {{/* Page-specific scripts */}}
  {{ block "scripts" . }}{{ end }}

  {{/* Service Worker registration */}}
  {{ partial "michael/sw-register.html" . }}
</body>
</html>
